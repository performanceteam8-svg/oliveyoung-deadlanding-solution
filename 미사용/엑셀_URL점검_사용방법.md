# 엑셀에서 URL 점검 실행 방법 ([URL] 시트 사용)

기존 **데드랜딩 솔루션 시트** 엑셀 파일 안에 **[URL]** 탭을 만들고, Link 시트의 영국(E)·이스라엘(F) URL을 수집·중복 제거 후 점검한 결과를 [URL] 시트에 채우는 방법입니다.

---

## 1. 준비

- **엑셀 파일**: 데드랜딩 솔루션 시트.xlsx (또는 사용 중인 통합문서)
- **Link 탭**: 시트 이름이 **"1) Link"** 이어야 합니다. (다르면 매크로 안에서 상수만 수정)
- **매크로 파일**: `데드랜딩_URL점검_매크로.bas` (이 프로젝트 폴더에 있음)

---

## 2. 매크로를 엑셀 통합문서에 넣기

1. **엑셀에서 해당 통합문서를 연다.** (데드랜딩 솔루션 시트.xlsx)
2. **Alt + F11** 을 눌러 **VBA 편집기**를 연다.
3. 메뉴에서 **파일 → 가져오기** (또는 **File → Import File**) 를 선택한다.
4. **데드랜딩_URL점검_매크로.bas** 파일을 선택해 가져온다.  
   - 또는 **삽입 → 모듈** 로 새 모듈을 만든 뒤, `.bas` 파일을 메모장으로 열어 **전체 내용을 복사**해 모듈 창에 **붙여넣기** 해도 된다.
5. VBA 편집기를 닫거나 **Alt + Q** 로 엑셀 화면으로 돌아온다.
6. **파일 → 다른 이름으로 저장** 에서 **Excel 매크로 사용 통합문서 (*.xlsm)** 로 저장한다.  
   - 이미 .xlsm 이면 그대로 저장하면 된다.

---

## 3. 매크로 실행 (URL 점검)

1. **같은 엑셀 통합문서**가 열린 상태에서 **Alt + F8** 을 누른다.
2. 매크로 목록에서 **데드랜딩_URL_점검_실행** 을 선택하고 **실행** 을 누른다.
3. 처리되는 동안 잠시 기다린다. (URL 개수에 따라 1~수 분 걸릴 수 있음)
4. 완료되면 **"[URL] 시트를 확인하세요"** 메시지가 뜬다. **확인** 을 누른다.
5. 시트 탭에 **"[URL]"** 이 생겨 있고, 그 안에  
   - **영국** 블록: URL 목록(중복 제거) + 검증결과(정상/오류)  
   - **이스라엘** 블록: URL 목록(중복 제거) + 검증결과(정상/오류)  
   가 채워져 있다.

---

## 4. [URL] 시트 구조

| 영역 | A열 | B열 |
|------|-----|-----|
| 영국 | "영국" (제목) | |
| | URL | 검증결과 |
| | (중복 제거된 영국 URL 목록) | 정상 / 오류 |
| (빈 행) | | |
| 이스라엘 | "이스라엘" (제목) | |
| | URL | 검증결과 |
| | (중복 제거된 이스라엘 URL 목록) | 정상 / 오류 |

---

## 5. Link 시트 이름이 "1) Link" 가 아닐 때

1. **Alt + F11** 로 VBA 편집기를 연다.
2. **프로젝트** 창에서 **DeadLandingUrlCheck** (또는 가져온 모듈) 를 더블클릭한다.
3. 맨 위쪽에 있는 다음 줄을 찾는다.  
   `Private Const LINK_SHEET_NAME As String = "1) Link"`
4. **"1) Link"** 를 실제 Link 탭 이름으로 바꾼다. (예: `"Link"`, `"링크"` 등)
5. **Ctrl + S** 로 저장한 뒤 VBA 편집기를 닫는다.

---

## 6. 실행 시 오류가 날 때

- **"시트 '1) Link'를 찾을 수 없습니다"**  
  → Link 탭 이름을 위 5번처럼 `LINK_SHEET_NAME` 에 맞게 수정한다.

- **"WinHttp.WinHttpRequest" 관련 오류**  
  → Windows 업데이트 또는 Office 버전에 따라 다른 방식이 필요할 수 있다.  
  → 회사 PC에서는 보안 정책으로 매크로/인터넷 접속이 막혀 있을 수 있어, PC 관리자에게 문의한다.

- **매크로가 목록에 안 보인다**  
  → .xlsm 으로 저장했는지, 매크로를 사용하도록 설정했는지 확인한다.  
  → 파일 → 옵션 → 보안 센터 → 보안 센터 설정 → 매크로 설정에서 **"알림을 표시하고 매크로 사용 여부 선택"** 또는 **"모든 매크로 포함"** 을 선택한 뒤 다시 열고 **Alt + F8** 로 확인한다.

이렇게 하면 **로컬 터미널 없이**, **엑셀 파일만 열고** 기존 통합문서 안에 **[URL]** 시트를 만들어 URL 점검 결과를 볼 수 있다.
