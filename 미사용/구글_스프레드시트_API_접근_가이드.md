# 구글 스프레드시트 API로 접근하는 구체적인 방법

수동 작업 없이 **Google Sheets API**로 "데드랜딩 솔루션 시트"를 읽고 쓰려면 아래 순서대로 진행하면 됩니다.

---

## 1. 필요한 것

- **Google 계정** (스프레드시트 소유 계정)
- **Google Cloud 프로젝트** 1개 (무료로 생성 가능)
- **서비스 계정** 1개 + **JSON 키 파일** 1개
- **스프레드시트를 서비스 계정 이메일과 공유** (편집자 권한)

API 사용량은 일일 할당량 안에서는 **무료**입니다. (읽기/쓰기 요청 수 제한 있음)

---

## 2. Google Cloud에서 프로젝트 만들기

1. **Google Cloud Console** 접속  
   - https://console.cloud.google.com/
2. 상단 프로젝트 선택 → **"새 프로젝트"** 클릭
3. **프로젝트 이름** 입력 (예: `dead-landing-check`) → **만들기**
4. 만들어진 프로젝트를 **선택**한 상태로 다음 단계로 진행

---

## 3. Google Sheets API 사용 설정

1. 왼쪽 메뉴 **☰** → **API 및 서비스** → **라이브러리**
2. **"Google Sheets API"** 검색 후 클릭
3. **"사용"** 버튼 클릭
4. (선택) **"Google Drive API"** 도 검색해서 **사용** 처리해 두면, 나중에 파일 목록 조회 등에 쓸 수 있음

---

## 4. 서비스 계정 만들기 + 키 받기

1. 왼쪽 메뉴 **☰** → **API 및 서비스** → **사용자 인증 정보**
2. **"+ 사용자 인증 정보 만들기"** → **"서비스 계정"** 선택
3. **서비스 계정 이름** 입력 (예: `dead-landing-bot`) → **만들기 및 계속**
4. **역할**은 비워두거나 **편집자** 등 선택 후 **계속** → **완료**
5. 방금 만든 **서비스 계정** 행을 클릭
6. **"키"** 탭 → **"키 추가"** → **"새 키 만들기"**
7. **JSON** 선택 → **만들기**  
   → JSON 키 파일이 PC에 **다운로드**됨
8. 이 파일을 **안전한 폴더**에 두고, **절대 Git/공개 저장소에 올리지 않음**  
   - 예: 프로젝트 폴더 안 `credentials/` 같은 곳에 두고, `.gitignore`에 `credentials/*.json` 추가

**JSON 파일 안에 보이는 `client_email`** (예: `xxx@xxx.iam.gserviceaccount.com`) 이 **서비스 계정 이메일**입니다. 다음 단계에서 이 이메일을 스프레드시트에 공유합니다.

---

## 5. 스프레드시트를 서비스 계정과 공유

1. **데드랜딩 솔루션 시트** (구글 스프레드시트)를 브라우저에서 연다
2. 우측 상단 **"공유"** 버튼 클릭
3. **"사용자 또는 그룹 추가"** 칸에 위에서 적어둔 **서비스 계정 이메일** (`client_email`) 을 붙여넣기
4. 권한을 **편집자**로 선택
5. **전송** (또는 **공유**) 클릭

이렇게 하면 **API로 해당 스프레드시트를 읽고 쓸 수 있습니다.**  
(링크가 있는 모든 사용자 공유는 유지해도 되고, 서비스 계정만 편집자로 추가하면 됩니다.)

---

## 6. 프로젝트(코드)에서 쓰는 방법

### 6.1 스프레드시트/시트 지정

- **스프레드시트 ID**: URL에 있는 긴 영문+숫자  
  - 예: `https://docs.google.com/spreadsheets/d/1iZuRoTV25gyAREoQaOY8TlYXfPhQXfFYUbzAzTKM9Og/edit...`  
  - **스프레드시트 ID** = `1iZuRoTV25gyAREoQaOY8TlYXfPhQXfFYUbzAzTKM9Og`
- **시트(탭)**  
  - 시트 이름으로 지정 (예: `1) Link`, `[URL]`)  
  - 또는 시트 ID(gid)로 지정 가능 (예: `gid=2133845638` → "1) Link" 탭)

### 6.2 Python 예시 (gspread + 서비스 계정)

1. **패키지 설치**
   ```bash
   pip install gspread google-auth
   ```
2. **인증**
   - 서비스 계정 JSON 키 파일 경로를 환경 변수나 코드에 지정
   - `google.oauth2.service_account.Credentials.from_service_account_file(경로)` 로 인증
3. **연결**
   - `gspread.authorize(credentials)` 로 클라이언트 생성
   - `client.open_by_key(스프레드시트_ID)` 로 스프레드시트 열기
   - `.worksheet("시트이름")` 또는 `.get_worksheet(인덱스)` 로 시트 선택
4. **읽기**
   - `sheet.get_all_values()` → 전체를 리스트로
   - `sheet.get("B18:B")` → B열 18행부터 (A1 표기)
   - `sheet.get("E18:F1000")` → E열·F열 특정 범위
5. **쓰기**
   - `sheet.update("V18:W100", [[값들]])` → V열·W열에 한 번에 기록
   - 또는 `sheet.update_acell("V18", "정상")` 처럼 셀 단위

이렇게 하면 **수동으로 엑셀/VBA를 열지 않고**, 스크립트만 실행해도 스프레드시트를 읽고 쓸 수 있습니다.

---

## 7. 정리

| 단계 | 내용 |
|------|------|
| 1 | Google Cloud에서 프로젝트 생성 |
| 2 | Google Sheets API 사용 설정 |
| 3 | 서비스 계정 생성 후 JSON 키 다운로드 |
| 4 | 스프레드시트를 서비스 계정 이메일과 **편집자**로 공유 |
| 5 | 코드에서 JSON 키로 인증 → 스프레드시트 ID + 시트 이름으로 읽기/쓰기 |

**보안**
- JSON 키 파일은 **절대 공개 저장소에 올리지 않기**
- 환경 변수로 키 경로만 넘기거나, 서버/로컬의 안전한 폴더에만 두기

이 순서대로 하면 API로 스프레드시트에 접근할 수 있고, 이후 데드랜딩 점검 로직을 이 API 위에 붙이면 됩니다.
