# 시트 접근 확인 결과 (편집 권한 부여 후)

## 시트 정보
- **파일명**: 데드랜딩 솔루션 시트
- **Spreadsheet ID**: `1iZuRoTV25gyAREoQaOY8TlYXfPhQXfFYUbzAzTKM9Og`
- **탭**: 1) Link (gid=2133845638)

---

## 1. 확인한 내용

### 1) B열 시작일 형식
- **형식**: `250101` (YYMMDD)
- **90일 계산**: `250101` → 2025년 1월 1일로 파싱 후, 오늘 기준 90일 이내인지 비교하면 됨.
- **구현**: `datetime` 등으로 파싱 가능. (예: 25 → 2025, 01 → 월, 01 → 일)

### 2) 시트 접근 (편집 권한 부여 후)
- **원격(제가 시도한 fetch)**: 여전히 로그인 페이지 반환.
- **사용자 PC 터미널**: `WinError 10061`(연결 거부) 발생 — 방화벽/프록시/샌드박스 등 환경 이슈 가능성 있음.

**직접 확인 방법 (사용자 환경)**  
브라우저에서 **시크릿 창(비로그인)** 으로 아래 주소를 열어보세요.

```
https://docs.google.com/spreadsheets/d/1iZuRoTV25gyAREoQaOY8TlYXfPhQXfFYUbzAzTKM9Og/export?format=csv&gid=2133845638
```

- **CSV 파일이 다운로드되면** → “링크 있는 모든 사용자(편집)”만으로도 비로그인 export 가능.  
  자동화 시 이 URL만으로 읽기는 가능하고, **쓰기(V/W열)는 불가**하므로 Google Sheets API가 필요.
- **로그인 페이지가 뜨면** → 비로그인 export는 안 되는 설정.  
  자동화는 **Google Sheets API + 서비스 계정(또는 OAuth)** 으로 진행하는 것이 안전합니다.

---

## 2. 구현 가능 여부 정리

| 항목 | 내용 | 비고 |
|------|------|------|
| 시트 | 데드랜딩 솔루션 시트 (`1iZuRoTV25gyAREoQaOY8TlYXfPhQXfFYUbzAzTKM9Og`, 탭 gid=2133845638) | ✅ |
| B열 시작일 | `250101` (YYMMDD), 최근 90일 이내만 사용 | ✅ 파싱·비교 가능 |
| E열 / F열 | 검증 대상 링크 | ✅ |
| V열 / W열 | E열 결과 → V열, F열 결과 → W열 | ✅ API로 쓰기 가능 |
| 결과 값 | 정상 / 오류 | ✅ |

**결론**:  
- B열 `250101` 형식과 “최근 90일 이내만 검증”은 **그대로 구현 가능**합니다.  
- “링크가 있는 모든 사용자 **편집**”으로 두셨으니,  
  - **읽기**: 위 CSV URL이 시크릿 창에서 다운로드되면 그 URL만으로도 가능(선택).  
  - **쓰기(V/W열)** 및 안정적인 자동화를 위해서는 **Google Sheets API + 서비스 계정** 사용을 권장합니다.  
  - 서비스 계정 이메일을 해당 시트의 “편집자”로 추가하시면, 별도 로그인 없이 API로 읽기/쓰기 가능합니다.
