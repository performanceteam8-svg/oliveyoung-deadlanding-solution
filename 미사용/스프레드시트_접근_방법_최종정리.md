# 구글 스프레드시트 접근 방법 최종 정리

API 외에 스프레드시트에 접근할 수 있는 방법이 있는지, 각각의 가능 여부와 한계를 정리했습니다.

---

## 1. Google Sheets API (서비스 계정 / OAuth)

| 항목 | 내용 |
|------|------|
| **읽기** | ✅ 가능 (안정적) |
| **쓰기** | ✅ 가능 (안정적) |
| **자동화** | ✅ 스크립트/서버에서 호출 가능 |
| **필요한 것** | 서비스 계정 JSON 키 또는 OAuth 인증 |
| **한계** | 키 관리·설정 필요, 할당량 내 사용 |

**정리**: 외부에서 **읽기+쓰기**를 **안정적으로 자동화**하려면 **API 사용이 사실상 유일한 방법**입니다.

---

## 2. CSV 내보내기 URL (export link)

| 항목 | 내용 |
|------|------|
| **URL 형태** | `https://docs.google.com/spreadsheets/d/{ID}/export?format=csv&gid={시트ID}` |
| **읽기** | ⚠️ 경우에 따라 가능 (브라우저·환경에 따라 로그인/캡차 요구) |
| **쓰기** | ❌ 불가능 (GET만 가능) |
| **자동화** | ⚠️ 스크립트에서 요청 시 차단·로그인 유도되는 경우 많음 |

**정리**:  
- **쓰기는 불가**하고, **읽기만** 이론상 가능하지만 스크립트/봇 요청 시 로그인 페이지나 캡차가 나와 **자동화에는 불안정**합니다.  
- “링크 있는 모든 사용자”로 열어도, **비로그인·프로그램 요청**에는 Google이 로그인을 요구할 수 있습니다.

---

## 3. Google Apps Script (스프레드시트에 붙여서 실행)

| 항목 | 내용 |
|------|------|
| **위치** | 스프레드시트 메뉴 **확장 프로그램 → Apps Script** |
| **읽기** | ✅ 같은 통합문서/권한 있는 시트 읽기 가능 |
| **쓰기** | ✅ 같은 통합문서에 쓰기 가능 |
| **자동화** | ✅ 시간 기반 트리거, 수동 실행, Web App URL 호출 등 |
| **필요한 것** | Google 계정으로 스크립트 작성·배포 (API 키/서비스 계정 불필요) |

**정리**:  
- **API를 “내 PC/서버”에서 쓰지 않고** 스프레드시트에 접근하는 방법입니다.  
- 스크립트가 **Google 쪽에서** 돌기 때문에, 시트 읽기/쓰기는 **API와 같은 백엔드**를 쓰는 것이지만, **사용자 입장에서는 “API 키 없이”** 접근하는 방식입니다.  
- URL 점검은 `UrlFetchApp.fetch()` 로 가능하고, 트리거로 **매일 10시 실행** 같은 것도 설정할 수 있습니다.

---

## 4. 수동 다운로드 후 로컬 파일로 처리

| 항목 | 내용 |
|------|------|
| **방식** | 사용자가 스프레드시트에서 **파일 → 다운로드 → CSV** 등으로 저장 후, 그 파일을 스크립트가 읽음 |
| **읽기** | ✅ 로컬 CSV/엑셀 파일 읽기만 가능 |
| **쓰기** | ❌ 스프레드시트에는 반영 안 됨 (로컬 파일만 수정 가능) |
| **자동화** | ❌ 매번 사람이 다운로드해야 함 |

**정리**: 스프레드시트 **자체**에 접근하는 방식이 아니라, **이미 내려받은 파일**만 다루는 방식입니다. 완전 자동화·실시간 반영에는 부적합합니다.

---

## 5. 서드파티 연동 (Zapier, Make 등)

| 항목 | 내용 |
|------|------|
| **방식** | Zapier, Make(Integromat) 등이 구글 시트와 연동 |
| **실제 동작** | 내부적으로 **Google API(OAuth)** 를 사용 |
| **정리** | “API 외”가 아니라 **API를 서비스가 대신 호출**하는 형태입니다. |

---

## 최종 결론

| 목적 | API 외 방법 가능 여부 | 비고 |
|------|------------------------|------|
| **스프레드시트 읽기 + 쓰기 자동화** (내 PC/서버 스크립트) | ❌ 없음 | **API(서비스 계정 등) 사용이 유일한 안정적 방법** |
| **스프레드시트 읽기만** (자동화) | ⚠️ export URL은 이론상 가능하나 불안정, 쓰기 불가 | 실무 자동화에는 API 권장 |
| **API 키/서비스 계정 없이** 스프레드시트 접근·자동화 | ✅ **Google Apps Script** | 시트에 붙은 스크립트에서 읽기/쓰기·URL 점검·트리거 가능 |

**한 줄 요약**:  
- **내 코드(예: Python)에서 스프레드시트를 읽고 쓰려면 → API(서비스 계정 또는 OAuth)가 필요하다.**  
- **API를 쓰지 않는 대안**으로는 **Google Apps Script**만 있으며, 이 경우 “API 키를 직접 관리하지 않고” 스프레드시트에 접근·자동화할 수 있습니다.
