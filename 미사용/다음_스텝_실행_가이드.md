# 지금 바로 할 다음 스텝 (한 단계씩)

`credentials` 폴더에 JSON 파일을 넣었고, API 이메일로 스프레드시트 권한도 부여한 상태입니다.  
아래 순서대로만 하면 연결 테스트까지 완료할 수 있습니다.

---

## Step 1. 터미널 열기

- **Windows**: `Win + R` → `powershell` 입력 → Enter  
  또는 Cursor/VS Code 하단 **터미널** 탭 클릭
- 열린 창에서 **현재 위치**가 어디인지 확인 (나중에 Step 3에서 프로젝트 폴더로 이동합니다)

---

## Step 2. 프로젝트 폴더로 이동

터미널에 **아래 한 줄**을 그대로 입력한 뒤 Enter를 누릅니다.

```text
C:\Users\MADUP> cd vibecoding
```

- `C:\Users\MADUP` 에서 시작한 뒤 `vibecoding` 폴더로 이동합니다. (프로젝트를 다른 경로에 저장했다면 그 경로로 바꿔서 입력)
- 성공하면 다음 줄에 `C:\Users\MADUP\vibecoding>` 처럼 경로가 보입니다.

---

## Step 3. Python 패키지 설치

같은 터미널에서 **아래 한 줄**을 입력한 뒤 Enter를 누릅니다.

```text
C:\Users\MADUP\vibecoding> pip install gspread google-auth
```

- `gspread`: 구글 스프레드시트 읽기/쓰기
- `google-auth`: 서비스 계정 JSON으로 로그인

설치가 끝나면 `Successfully installed ...` 같은 메시지가 나옵니다. (이미 설치되어 있으면 그대로 넘어갑니다.)

---

## Step 4. 스프레드시트 ID 확인

연결할 **데드랜딩용 구글 스프레드시트**를 브라우저에서 엽니다.

1. 주소창 URL을 확인합니다.  
   예: `https://docs.google.com/spreadsheets/d/1iZuRoTV25gyAREoQaOY8TlYXfPhQXfFYUbzAzTKM9Og/edit#gid=...`
2. **`/d/` 와 `/edit` 사이**에 있는 긴 영문+숫자 문자열이 **스프레드시트 ID**입니다.  
   위 예시에서는 `1iZuRoTV25gyAREoQaOY8TlYXfPhQXfFYUbzAzTKM9Og`
3. 이 ID를 **메모장에 복사**해 둡니다.

---

## Step 5. 스크립트에 스프레드시트 ID 넣기 (본인 시트일 때만)

**Step 4에서 복사한 ID가** `1iZuRoTV25gyAREoQaOY8TlYXfPhQXfFYUbzAzTKM9Og` **와 같다면**  
→ 이 단계는 **건너뛰고** Step 6으로 가세요.

**다른 스프레드시트를 쓰는 경우**만 아래를 합니다.

1. Cursor에서 **`spreadsheet_connect_test.py`** 파일을 엽니다.
2. **16~18번째 줄** 근처를 찾습니다.  
   `SPREADSHEET_ID = os.environ.get( ... "1iZuRoTV25gyAREoQaOY8TlYXfPhQXfFYUbzAzTKM9Og" )`
3. **큰따옴표 안의 ID**를 지우고, Step 4에서 복사한 **본인 스프레드시트 ID**를 붙여넣습니다.
4. **저장** (Ctrl + S) 합니다.

---

## Step 6. 연결 테스트 실행

터미널에서 **아래 한 줄**을 입력한 뒤 Enter를 누릅니다.

```text
C:\Users\MADUP\vibecoding> python spreadsheet_connect_test.py
```

- **"연결 성공"** 이 나오면: API·JSON·스프레드시트 권한이 모두 정상입니다.  
  → 다음에는 `dead_landing_check_sheets.py` 를 실행하면 됩니다.
- **에러 메시지**가 나오면: 아래 "에러가 났을 때" 를 확인합니다.

---

## 에러가 났을 때

| 나온 메시지 | 확인할 것 |
|-------------|-----------|
| **JSON 키 파일을 찾을 수 없습니다** | `vibecoding/credentials/` 폴더 안에 `oliveyoung-eu-5e0a60023b49.json` 파일이 있는지 확인. 파일명이 다르면 알려주세요. |
| **403 / 권한이 없습니다** | 스프레드시트 **공유**에서 서비스 계정 이메일(JSON 파일을 연 다음 `client_email` 값)을 **편집자**로 추가했는지 다시 확인. |
| **404 / 스프레드시트를 찾을 수 없음** | Step 4에서 복사한 스프레드시트 ID가 URL의 `/d/` 와 `/edit` 사이 문자열과 **완전히 같은지** 확인. Step 5에서 ID를 바꿨다면 저장했는지 확인. |
| **시트를 찾을 수 없습니다** | 스프레드시트 **맨 아래 탭** 중 하나의 이름이 **"1) Link"** 인지 확인. (공백, 괄호 포함) 이름이 다르면 알려주시면 스크립트 수정 방법을 안내합니다. |
| **패키지가 필요합니다** | Step 3을 다시 실행: `pip install gspread google-auth` |
| **python을 찾을 수 없습니다** | Python이 설치되어 있는지 확인. Cursor/VS Code에서 Python 인터프리터가 선택되어 있는지 확인. |

---

## 체크리스트

- [ ] Step 1: 터미널 열기
- [ ] Step 2: `C:\Users\MADUP> cd vibecoding` 실행
- [ ] Step 3: `pip install gspread google-auth` 실행
- [ ] Step 4: 스프레드시트 URL에서 스프레드시트 ID 복사
- [ ] Step 5: (본인 시트일 때만) 스크립트에 스프레드시트 ID 넣고 저장
- [ ] Step 6: `python spreadsheet_connect_test.py` 실행 → "연결 성공" 확인

여기까지 되면 설정은 끝입니다. 다음에는 데드랜딩 점검 스크립트(`dead_landing_check_sheets.py`)를 같은 방식으로 실행하면 됩니다.
